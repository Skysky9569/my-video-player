<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chill</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
        }

        .main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .video-section, .playlist-section {
            background-color: #1e1e1e;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            width: 100%;
            max-width: 800px;
        }

        header {
            padding: 20px;
            background-color: #2a2a2a;
            border-bottom: 1px solid #333;
        }

        h1 {
            margin: 0;
            font-size: 1.8em;
            color: #ffffff;
            text-align: center;
        }

        /* Bọc video và control để dễ dàng cho việc hiển thị */
        .video-wrapper {
            position: relative;
        }
        
        video {
            width: 100%;
            display: block; /* Loại bỏ khoảng trống thừa */
        }
        
        /* --- CSS CHO KHU VỰC ĐIỀU KHIỂN TÙY CHỈNH --- */
        .controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            background-color: rgba(0, 0, 0, 0.6);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        /* Hiện control khi di chuột vào video */
        .video-wrapper:hover .controls {
            opacity: 1;
        }

        .controls button {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }
        
        .progress-container {
            flex-grow: 1;
            position: relative;
            display: flex;
            align-items: center;
            height: 15px; /* Tăng vùng click */
        }

        #buffer-bar {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 5px;
            width: 0%; /* Bắt đầu với 0% */
            background-color: #6c757d; /* Màu xám cho thanh buffer */
            border-radius: 5px;
            pointer-events: none; /* Cho phép click xuyên qua */
        }

        #progress-bar {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 5px;
            background: rgba(255, 255, 255, 0.3); /* Nền mờ cho thanh chưa chạy */
            outline: none;
            border-radius: 5px;
            position: relative;
            cursor: pointer;
        }
        
        /* CSS cho phần đã chạy của thanh progress */
        #progress-bar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 15px;
            height: 15px;
            background: #007bff;
            border-radius: 50%;
            cursor: pointer;
        }

        #progress-bar::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: #007bff;
            border-radius: 50%;
            cursor: pointer;
        }

        .time-display {
            color: white;
            font-size: 14px;
            min-width: 90px;
        }

        .playlist { padding: 20px; }
        h2 { margin-top: 0; border-bottom: 2px solid #333; padding-bottom: 10px; font-size: 1.4em; }
        .playlist-item { padding: 15px; cursor: pointer; border-bottom: 1px solid #333; transition: background-color 0.3s; }
        .playlist-item:last-child { border-bottom: none; }
        .playlist-item:hover { background-color: #2c2c2c; }
        .playlist-item.active { background-color: #007bff; color: #fff; font-weight: bold; }
    </style>
</head>
<body>

<div class="main-container">

    <div class="video-section">
        <header>
            <h1>Tổng hợp máy cái chill=)</h1>
        </header>
        <div class="video-wrapper">
            <video id="videoPlayer" autoplay muted>
                Trình duyệt của bạn không hỗ trợ thẻ video.
            </video>
            
            <div class="controls">
                <button id="play-pause-btn">⏸️</button>
                <div class="progress-container">
                    <div id="buffer-bar"></div>
                    <input type="range" id="progress-bar" value="0">
                </div>
                <div class="time-display">
                    <span id="current-time">00:00</span> / <span id="duration">00:00</span>
                </div>
            </div>
        </div>
    </div>

    <div class="playlist-section">
        <div class="playlist">
            <h2>Danh sách phát</h2>
            <div id="playlist-container"></div>
        </div>
    </div>

</div>

<script>
    const videos = [
        { title: "intro 1", filename: "video.mp4" },
        { title: "Anh Mệt Rồi", filename: "anhmetroi.mp4" },
        { title: "Chờ đợi có đáng sợ", filename: "chodoicodangsotik1.mp4" },
        { title: "Như anh mơ", filename: "nhuanhmo.mp4"}
    ];

    const videoPlayer = document.getElementById('videoPlayer');
    const playlistContainer = document.getElementById('playlist-container');
    let currentVideoIndex = 0;

    // --- LẤY RA CÁC PHẦN TỬ ĐIỀU KHIỂN MỚI ---
    const playPauseBtn = document.getElementById('play-pause-btn');
    const progressBar = document.getElementById('progress-bar');
    const bufferBar = document.getElementById('buffer-bar');
    const currentTimeElem = document.getElementById('current-time');
    const durationElem = document.getElementById('duration');

    // --- PHẦN LOGIC CHO CÁC NÚT ĐIỀU KHIỂN ---

    // 1. Nút Play/Pause
    function togglePlayPause() {
        if (videoPlayer.paused) {
            videoPlayer.play();
            playPauseBtn.textContent = '⏸️';
        } else {
            videoPlayer.pause();
            playPauseBtn.textContent = '▶️';
        }
    }
    playPauseBtn.addEventListener('click', togglePlayPause);
    videoPlayer.addEventListener('click', togglePlayPause); // Cho phép click vào video để play/pause

    // 2. Cập nhật thanh tiến trình và thời gian
    videoPlayer.addEventListener('timeupdate', () => {
        // Cập nhật thanh progress
        const progressPercentage = (videoPlayer.currentTime / videoPlayer.duration) * 100;
        progressBar.value = progressPercentage;
        
        // Cập nhật thời gian hiện tại
        currentTimeElem.textContent = formatTime(videoPlayer.currentTime);
    });

    // 3. Cho phép tua video (seek)
    progressBar.addEventListener('input', () => {
        const seekTime = (progressBar.value / 100) * videoPlayer.duration;
        videoPlayer.currentTime = seekTime;
    });

    // 4. Cập nhật thanh tiến trình LOAD (BUFFER)
    videoPlayer.addEventListener('progress', () => {
        if (videoPlayer.duration > 0 && videoPlayer.buffered.length > 0) {
            const bufferedEnd = videoPlayer.buffered.end(videoPlayer.buffered.length - 1);
            const bufferPercentage = (bufferedEnd / videoPlayer.duration) * 100;
            bufferBar.style.width = `${bufferPercentage}%`;
        }
    });

    // 5. Hiển thị tổng thời lượng video
    videoPlayer.addEventListener('loadedmetadata', () => {
        durationElem.textContent = formatTime(videoPlayer.duration);
    });

    // --- LOGIC CHO PLAYLIST (giữ nguyên) ---

    function createPlaylistItem(video, index) { /* ... giữ nguyên ... */ }
    function updateActivePlaylistItem() { /* ... giữ nguyên ... */ }
    function playVideo(index) { /* ... giữ nguyên ... */ }

    // (Code cho các hàm playlist)
    function createPlaylistItem(video, index) {
        const item = document.createElement('div');
        item.className = 'playlist-item';
        item.textContent = video.title;
        item.dataset.index = index;
        item.onclick = () => { playVideo(index); };
        playlistContainer.appendChild(item);
    }
    function updateActivePlaylistItem() {
        const items = document.querySelectorAll('.playlist-item');
        items.forEach((item, index) => {
            if (index === currentVideoIndex) {
                item.classList.add('active');
            } else {
                item.classList.remove('active');
            }
        });
    }
    function playVideo(index) {
        if (index >= videos.length || index < 0) return;
        currentVideoIndex = index;
        const video = videos[index];
        videoPlayer.src = `videos/${video.filename}`;
        videoPlayer.load();
        videoPlayer.play().catch(e => console.error("Autoplay bị chặn:", e));
        updateActivePlaylistItem();
        playPauseBtn.textContent = '⏸️'; // Cập nhật nút Play/Pause
    }

    videos.forEach(createPlaylistItem);
    if (videos.length > 0) { playVideo(0); }

    videoPlayer.onended = () => {
        const nextVideoIndex = (currentVideoIndex + 1) % videos.length;
        playVideo(nextVideoIndex);
    };

    // Hàm tiện ích để định dạng thời gian
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
</script>

</body>
</html>